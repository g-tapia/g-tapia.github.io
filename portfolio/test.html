<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Image to Particle Effect</title>
  <style>
    * {
      margin: 0;
      padding: 0;
    }

    body {
      overflow: hidden;
      background-color: black;
      font-family: 'Comfortaa', cursive;
    }

    #wrapper {
      position: relative;
      height: 100vh;
      width: 100vw;
    }

    #canvas_container {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100vh;
      z-index: 0;
    }

    .text {
      width: 100%;
      height: 100px;
      text-align: center;
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      z-index: 10;
      color: white;
      background-color: rgba(0, 0, 0, 0.81);
      font-size: 1.6rem;
      display: flex;
      align-items: center;
    }

    .text .quoteText {
      width: 85%;
      margin: 0 auto;
    }

    .clickInfo {
      width: 100%;
      text-align: center;
      position: absolute;
      left: 0;
      top: -80px;
      z-index: 11;
      color: #F9B31C;
      background-color: rgba(23, 23, 23, 0.9);
      padding: 10px 0;
      font-size: 20px;
    }

    .btn {
      position: absolute;
      bottom: 5%;
      right: 0px;
      transform: translateX(-50%);
      border: 1px solid white;
      border-radius: 5px;
      font-size: 0.9rem;
      padding: 0.5rem 0.7em;
      background: transparent;
      color: #F9B31C;
      font-weight: 700;
      cursor: pointer;
      z-index: 11;
    }

    .btn:hover {
      background: white;
      color: black;
    }
  </style>
</head>
<body>
  <div id="wrapper">
    <div id="canvas_container"></div>

    <div class="text">
      <p class="quoteText">“ Never memorize something that you can look up.”<br>
        <span style="font-style: italic; font-size: 1.4rem; color:#ED760D">#Stack Overflow</span>
      </p>
    </div>

    <p class="clickInfo">Click anywhere to start your journey</p>

    <button class="btn" id="fullscr">Go Fullscreen</button>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/gsap.min.js"></script>

  <script>
    let webgl = {};
    let imagesLoaded = false;

    // Quotes
    const quotes = [
      "“ Never memorize something that you can look up.”",
      "“ Creativity is intelligence having fun.”",
      "“ The best way to predict the future is to invent it.”",
      "“ Simplicity is the ultimate sophistication.”"
    ];

    let currentQuoteIndex = 0;

    function updateQuote() {
      const quoteText = document.querySelector(".quoteText");
      gsap.to(quoteText, { opacity: 0, duration: 0.5, onComplete: () => {
        quoteText.innerHTML = `${quotes[currentQuoteIndex]}<br>
        <span style="font-style: italic; font-size: 1.4rem; color:#ED760D">#Stack Overflow</span>`;
        gsap.to(quoteText, { opacity: 1, duration: 0.5 });
      }});

      // Cycle through quotes
      currentQuoteIndex = (currentQuoteIndex + 1) % quotes.length;
    }

    function initThree() {
      webgl.container = document.getElementById("canvas_container");

      // Scene
      webgl.scene = new THREE.Scene();
      
      // Camera
      webgl.camera = new THREE.PerspectiveCamera(50, window.innerWidth / window.innerHeight, 0.1, 10000);
      webgl.camera.position.z = 300;

      // Renderer
      webgl.renderer = new THREE.WebGLRenderer({ alpha: true });
      webgl.renderer.setSize(window.innerWidth, window.innerHeight);
      webgl.container.appendChild(webgl.renderer.domElement);

      // Load images as textures
      webgl.textureLoader = new THREE.TextureLoader();
      webgl.images = [
        "https://media.gettyimages.com/id/86146687/photo/los-angeles-ca-kobe-bryant-of-the-los-angeles-lakers-reacts-in-the-second-quarter-against-the.jpg?s=612x612&w=gi&k=20&c=7YPCXVIXIqO9ryF9DTJLo7JN6ecIccPudVeRW2Sau9s=",
        "https://i.ibb.co/WnbfKGk/2.jpg",
        "https://i.ibb.co/4RWFQtT/3.jpg"
      ];

      webgl.textures = [];
      loadImages();
    }

    function loadImages() {
      let loadCount = 0;

      webgl.images.forEach((url, index) => {
        webgl.textureLoader.load(url, (texture) => {
          webgl.textures[index] = texture;
          loadCount++;

          if (loadCount === webgl.images.length) {
            imagesLoaded = true;
            createParticles(webgl.textures[0]);
          }
        });
      });
    }

    function createParticles(texture) {
      const width = texture.image.width;
      const height = texture.image.height;
      const particleCount = width * height;
      const positions = new Float32Array(particleCount * 3);
      const colors = new Float32Array(particleCount * 3);

      const canvas = document.createElement('canvas');
      canvas.width = width;
      canvas.height = height;
      const ctx = canvas.getContext('2d');
      ctx.drawImage(texture.image, 0, 0);

      const imageData = ctx.getImageData(0, 0, width, height).data;

      let index = 0;
      for (let y = 0; y < height; y++) {
        for (let x = 0; x < width; x++) {
          const r = imageData[(x + y * width) * 4] / 255;
          const g = imageData[(x + y * width) * 4 + 1] / 255;
          const b = imageData[(x + y * width) * 4 + 2] / 255;

          positions[index * 3] = x - width / 2;
          positions[index * 3 + 1] = y - height / 2;
          positions[index * 3 + 2] = 0;

          colors[index * 3] = r;
          colors[index * 3 + 1] = g;
          colors[index * 3 + 2] = b;

          index++;
        }
      }

      const geometry = new THREE.BufferGeometry();
      geometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
      geometry.setAttribute('color', new THREE.BufferAttribute(colors, 3));

      const material = new THREE.PointsMaterial({
        size: 1,
        vertexColors: true
      });

      webgl.particles = new THREE.Points(geometry, material);
      webgl.scene.add(webgl.particles);
    }

    function animateParticles() {
      if (webgl.particles) {
        webgl.particles.rotation.y += 0.001;
      }
    }

    function animate() {
      webgl.renderer.render(webgl.scene, webgl.camera);
      animateParticles();
      requestAnimationFrame(animate);
    }

    // Fullscreen functionality
    let fsEnter = document.getElementById('fullscr');
    fsEnter.addEventListener('click', function(e) {
      e.preventDefault();
      if (!document.fullscreenElement) {
        document.documentElement.requestFullscreen();
        fsEnter.innerHTML = "Exit Fullscreen";
      } else {
        document.exitFullscreen();
        fsEnter.innerHTML = "Go Fullscreen";
      }
    });

    document.getElementById("wrapper").addEventListener("click", () => {
      if (imagesLoaded) {
        // Cycle through images and recreate particles
        let nextImageIndex = (currentQuoteIndex + 1) % webgl.textures.length;
        createParticles(webgl.textures[nextImageIndex]);
        updateQuote();
      }
    });

    window.addEventListener('resize', () => {
      webgl.camera.aspect = window.innerWidth / window.innerHeight;
      webgl.camera.updateProjectionMatrix();
      webgl.renderer.setSize(window.innerWidth, window.innerHeight);
    });

    // Initialize and start animation loop
    initThree();
    animate();

  </script>
</body>
</html>
